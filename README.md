# Алгоритм одноточечной радиопеленгации в условиях поляризационных замираний

Данный алгоритм изложен в [статье](https://docs.google.com/document/d/1AUVnF3-JmszWRAtkv5Pj1yXMIW-XD7yf/edit?usp=sharing&ouid=106536756661517443366&rtpof=true&sd=true).
На рисунке представлена триортгональная система поляризационного-избирательного приема. Антенная система имеет 3 парциальных канала. Совокупность парциальных выходных сигналов в момент времени **t** рассматривается как некоторый сигнальный вектор **U = [u1. u2, u3]**. Как сказано в [статье](https://docs.google.com/document/d/1AUVnF3-JmszWRAtkv5Pj1yXMIW-XD7yf/edit?usp=sharing&ouid=106536756661517443366&rtpof=true&sd=true), набору сигнальных векторов в различные моменты времени однозначно соответствуют значения угловых координат. 
![](https://github.com/jvSett/Single-point_radio-direction/blob/main/helpers/Vector_formation.jpg)

Моментам времени **t0, t1, ..., tn** соответствуют различные параметры поляризационного эллипса, порождающие массив неколлинеарных векторов U в сигнальном пространстве, лежащих в гиперплоскости, нормаль к которой - режим отсутствия приема пеленгуемого направления по любым возможным видам поляризации. Следовательно, реализацию процесса пеленгации можно свести к задаче регрессионого анализа, которая может быть эффективна решена на основе искусственной нейронной сети (ИНС).

# Структура нейронной сети

Приводим обобщенную схему ИНС. Сигналы с антенны оцифровываются с помощью трехканального цифрового радиоприемного устройства (SDR). Затем на основе сингулярного разложения корреляционной матрицы, сформированной из принятых сигналов, находится собственный вектор (сигнальный вектор), соответствующий максимальному числу корреляционной матрицы. 

![](https://github.com/jvSett/Single-point_radio-direction/blob/main/helpers/Neural_network_structure.jpg)

В блоке предварительной обработки производится накопление сигнальных векторов, принятых в различное время, и их преобразовывание к действительному вектору.

Таким образом осуществляется процесс обучения ИНС. Для реализации данного процесса применяется алгоритм обратного распространения ошибки, где в качестве функции ошибки использован критерий СКО измеренного пеленга.

Для обучения ИНС и последующего тестирования используется имитатор ионосферного канала на основе [модели Ваттерсона](https://radiophysics.unn.ru/sites/default/files/papers/2012_4_266.pdf) и модели триортогональной антенной системы.

Приведем схему формирования обучающей и тестовой выборки массива выходных сигналов **U**.
![](https://github.com/jvSett/Single-point_radio-direction/blob/main/helpers/Formation_arrays_for_model.jpg)

 Сигнал от источника поступает в имитатор ионосферного канала, в котором формируются независимые замирания для азимутальной компоненты (φ) и меридиональной компоненты  (θ) поляризаций сигнала. Затем сигналы поступают на имитатор антенной системы, где для каждого парциального канала сигналы различных поляризаций складываются весовыми коэффициентами, соответствующим значениям характеристик направленности триортогональной системы.
 
 # Датасет
 
 Ссылка на датасет https://drive.google.com/file/d/1W1AbRTznhhE9Ck1ZP1vDIhm4kgFrLoG4/view?usp=sharing. Данные для обучения представлены в виде комплексной матрицы  **X[P×O×M×T×L,K×N]**, где N – размерность антенной системы; K – число последовательных временных интервалов; L- число реализаций различных поляризационных замираний; Т – число реализаций квазипериодов поляризационных замираний; M – число реализаций отношения «сигнал/шум»; O - число углов мест ( (от 10 до 49 градусов с шагом 1 градус); P – число азимутов (от 0 до 359 градусов с шагом 1 градус)
 
 В рамках данной работы: N = 3; K = 10; L = 10; T = 4 (принимались значения 10 с, 5 с, 2 с, 1 с); M = 4 (принимались значения 30 дБ, 20 дБ, 10 дБ, 0 дБ).
 
 Реализованная ИНС состоит из двух скрытых слоев, которые полносвязанны между собой. Первый слой состоит из 100 нейронов, а второй – из 50 нейронов. В скрытых слоях применяется функция активации ReLU. Для процесса обучения применялся алгоритм оптимизации Adam (adaptive moment estimation) с learning rate равным 0,01 в начале обучения и его уменьшением 0,9 каждые 10 эпох. Для устранения переобучения ИНС применялась L2-регуляризация весов с коэффициентом 0,0001. Для создания и обучения ИНС была применяна библиотека PyTorch.

# Результаты

В рамках данной работы было проведено моделирование процессов работы предлагаемого алгоритма при помощи ИНС и собственно процессов пеленгации. Параллельно осуществлялось моделирование процессов пеленгации без ИНС, для последующего сопоставления результатов, а также комбинированиях обоих алгоритмов.

На рисунках приведены графики функции СКО от шага обучения (эпохи). Было произведено обучение на 300 эпохах и регуляризацией 0,0001 и на 500 эпохах с регуляризацией 0,0002. Как видно из данных, обучение достаточно быстро сходится как на обучаеющей выборке, так и на валидационной.

СКО от шага обучения при epochs = 300,  wregul = 0,0001:

![](https://github.com/jvSett/Single-point_radio-direction/blob/main/helpers/SKO_Model.jpg)

СКО от шага обучения при epochs = 500, wregul = 0,0002:

![](https://github.com/jvSett/Single-point_radio-direction/blob/main/helpers/SKO_Model_500.jpg)

Далее представим основные результаты, полученные в ходе моделирования при следующих вариациях параметров:

* отношение сигнал/шум - от 0 дБ до 30 дБ, с шагом 2 дБ;
* квазипериод поляризационных замираний - от 1 с до 10 с, с шагом 1 с;
* угловые координаты по азимуту - от 0 до 360 градусов, шагом 0,25;
* угловые координаты по углу места - от 10 до 50 градусов, с шагом 0.25.

На графиках показаны зависимости СКО определения азимута, полученные на тестовых выборках при различных значениях квазипериодов поляризационных замираний. Сплошными линиями на этих рисунках показаны графики зависимостей СКО от отношения сигнул/шум для алгоритма на основе ИНС. Пунктирными линиями - алгоритм без ИНС, штрих-пунктирными - усредненные результаты от двух алгоритмов.

![](https://github.com/jvSett/Single-point_radio-direction/blob/main/helpers/Tfading_10.jpg)
![](https://github.com/jvSett/Single-point_radio-direction/blob/main/helpers/Tfading_5.jpg)
![](https://github.com/jvSett/Single-point_radio-direction/blob/main/helpers/Tfading_2.jpg)
![](https://github.com/jvSett/Single-point_radio-direction/blob/main/helpers/Tfading_1.jpg)

Проведенный экспемент показал, что алгоритм достаточно эффективен, но достаточно чувствителен к квазипериоду поляризационных замираний, однако хорошо себя показывает в условиях больших квазипериодов поляризационных замираний и малых значений отношения сигнал/шум.

Все эксперименты проводились на **CPU**.
